/**
 * Starry night styles.
 */
@mixin styles {
    /*
     * Rehype plugin {@see https://o5p.me/fSI3OT}.
     * `.highlight*` classes are generated by plugin.
     */

    // Code block container.
    .highlight {
        overflow: hidden;
        line-height: 1em;
        background: rgb(var(--colors-color-starry-night));
        border: 1px solid rgb(var(--colors-color-starry-night-border));
        border-radius: 0.375rem;
    }

    // Header inside code block container.
    .highlight-header {
        display: flex;
        gap: 0.5em;
        justify-content: space-between;
        padding: 0.5em;
        color: rgb(var(--colors-color-starry-night-header-fg));
        background: rgb(var(--colors-color-starry-night-header));
        border-block-end: 1px solid rgb(var(--colors-color-starry-night-border));
        border-radius: 0.375rem 0.375rem 0 0;
    }

    // Language inside code block header.
    .highlight-language {
        padding: 0.25em 0.5em 0.15em;
        font-family: ui-monospace, monospace;
        font-size: 0.75em;
        color: rgb(var(--colors-color-starry-night-header-language-fg));
        text-transform: uppercase;
        background: rgb(var(--colors-color-starry-night-header-language));
        border-radius: 0.1875rem;
    }

    // Copy button inside code block header.
    .highlight-copy {
        position: relative;
        user-select: none;

        &:disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        &::after {
            margin: 0 0 0 0.5em;
            line-height: 1em;
            vertical-align: middle;
            content: '❏';
        }

        &::before {
            position: absolute;
            top: -25px;
            left: -18px;
            color: rgb(var(--colors-color-success));
            content: '✔';
            opacity: 0;
        }

        &:not(.-copy-success)::before {
            top: 0;
            visibility: hidden;
            opacity: 1;
        }

        &.-copy-success::before {
            transition:
                opacity 1s,
                top 1s;
        }
    }

    // Nested highlight styles.
    .highlight {
        // `<pre>` tag.
        > pre {
            padding: 0.8571em 0;
            margin: 0;
            background: none;
            border: 0;
            border-radius: 0;
            box-shadow: inset 0 0 2px 2px rgb(var(--colors-color-starry-night-box-shadows));

            // `<code>` tag.
            > code {
                display: grid;
                color: rgb(var(--colors-color-starry-night-fg));
            }
        }

        // Lines of code.
        .line {
            padding-inline: 1.1428em;

            // Focused and/or hovered lines of code.
            &:hover,
            &:focus:not(:focus-visible) {
                background: rgb(var(--colors-color-starry-night-hilited-lines));
            }
        }

        // Lines of code line numbers.
        .line-number {
            margin-inline-end: 1em;
            color: rgb(var(--colors-color-starry-night-syntax-gutter-mark-fg));
            user-select: none;
        }

        // Copy-in-progress and highlighted lines of code.
        > pre.-copy-in-progress .line,
        .line[data-highlighted] {
            background: rgb(var(--colors-color-starry-night-hilited-lines));

            // Highlighted line numbers.
            .line-number {
                color: rgb(var(--colors-color-starry-night-syntax-comment-fg));
            }
        }

        // Highlighted lines of code.
        .line[data-highlighted] {
            border-inline-start: 2px solid rgb(var(--colors-color-starry-night-syntax-comment-fg));
        }

        // Lines with shell prompt icons.
        .line-prompt {
            &::before {
                display: inline-block;
                width: 1em;
                height: 1em;
                margin-inline: -0.175em 0.35em;
                vertical-align: middle;
                content: '';
                background: rgb(var(--colors-color-starry-night-syntax-comment-fg));
            }

            &::before {
                // Define as a variable so that when autoprefixer runs it won’t end up duplicating this lengthy value.
                --highlight-line-prompt-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' fill-rule='evenodd' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' clip-rule='evenodd' viewBox='0 0 24 24'%3E%3Cpath d='M17 6C13 3 6 3 6 8c1 5 12 2 12 7 0 6-8 6-12 3m6-16v20'/%3E%3C/svg%3E");

                mask-image: var(--highlight-line-prompt-mask-image);
                mask-repeat: no-repeat;
                mask-position: top center;
                mask-size: contain;
            }
        }
    }

    /*
     * Pretty lights syntax; {@see https://o5p.me/i6E6m1}.
     * `.pl*` syntax classes are generated by pretty lights.
     */

    // Bold.
    .pl-mb {
        font-weight: bold;
    }

    // Italic.
    .pl-mi {
        font-style: italic;
    }

    // Comments.
    .pl-c {
        color: rgb(var(--colors-color-starry-night-syntax-comment-fg));
    }

    // Gutter marks; e.g., line numbers.
    .pl-sg {
        color: rgb(var(--colors-color-starry-night-syntax-gutter-mark-fg));
    }

    // Punctuation.
    .pl-pds,
    .pl-ms,
    .pl-ml {
        color: rgb(var(--colors-color-starry-night-syntax-punctuation-fg));
    }

    // Keywords.
    .pl-k {
        color: rgb(var(--colors-color-starry-night-syntax-keyword-fg));
    }

    // Variables.
    .pl-v,
    .pl-smw {
        color: rgb(var(--colors-color-starry-night-syntax-variable-fg));
    }

    // Constants.
    .pl-c1,
    .pl-s .pl-v {
        color: rgb(var(--colors-color-starry-night-syntax-constant-fg));
    }

    // Modifiers.
    .pl-smi,
    .pl-s .pl-s1 {
        color: rgb(var(--colors-color-starry-night-syntax-modifier-fg));
    }

    // Entities.
    .pl-e,
    .pl-en {
        color: rgb(var(--colors-color-starry-night-syntax-entity-fg));
    }

    // Entity tags.
    .pl-ent {
        color: rgb(var(--colors-color-starry-night-syntax-entity-tag-fg));
    }

    // Other; e.g., markdown links.
    .pl-corl {
        color: rgb(var(--colors-color-starry-night-syntax-other-link-fg));
        text-decoration: underline;
    }

    // Various strings.
    .pl-s,
    .pl-s .pl-pse .pl-s1,
    .pl-sr,
    .pl-sr .pl-cce,
    .pl-sr .pl-sre,
    .pl-sr .pl-sra {
        color: rgb(var(--colors-color-starry-night-syntax-string-fg));
    }

    // Regular expressions.
    .pl-sr .pl-cce {
        font-weight: bold;
        color: rgb(var(--colors-color-starry-night-syntax-regexp-fg));
    }

    // Markdown headers.
    .pl-mh,
    .pl-mh .pl-en {
        font-weight: bold;
        color: rgb(var(--colors-color-starry-night-syntax-entity-tag-fg));
    }

    // Range notation in a diff/patch.
    .pl-mdr {
        font-weight: bold;
        color: rgb(var(--colors-color-dazzle));
    }

    // New added lines in a diff/patch.
    .pl-mi1 {
        color: rgb(var(--colors-color-success-fg));
        background: rgb(var(--colors-color-success));
    }

    // Old removed lines in a diff/patch.
    .pl-md {
        color: rgb(var(--colors-color-danger-fg));
        background: rgb(var(--colors-color-danger));
    }

    // Changed lines in a diff/patch.
    .pl-mc {
        color: rgb(var(--colors-color-warning-fg));
        background: rgb(var(--colors-color-warning));
    }

    // Ignored lines in a diff/patch.
    .pl-mi2 {
        color: rgb(var(--colors-color-neutral-fg));
        background: rgb(var(--colors-color-neutral));
    }

    // Illegal, broken, or unrecognized syntax.
    .pl-ii {
        color: rgb(var(--colors-color-danger-fg));
        background: rgb(var(--colors-color-danger));
    }

    // Untested. Some kind of brackets.
    .pl-ba,
    .pl-bu {
        color: rgb(var(--colors-color-dazzle));
    }

    // Untested. Possibly whitespace.
    .pl-c2 {
        color: rgb(var(--colors-color-dark-fg));
        background: rgb(var(--colors-color-dark));
    }
}
