/**
 * C10n HTML transforms plugin.
 *
 * Vite is not aware of this config file's location.
 *
 * @note PLEASE DO NOT EDIT THIS FILE!
 * @note This entire file will be updated automatically.
 * @note Instead of editing here, please review <https://github.com/clevercanyon/skeleton>.
 */

import { $str } from '../../../../../node_modules/@clevercanyon/utilities/dist/index.js';

/**
 * Configures Vite HTML transforms plugin.
 *
 * @param   props Props from vite config file driver.
 *
 * @returns       Plugin configuration.
 */
export default async ({ staticDefs }) => {
    return {
        name: 'vite-plugin-c10n-html-transforms',

        transformIndexHtml(html) {
            for (const key of Object.keys(staticDefs) /* Replaces all static definition tokens. */) {
                html = html.replace(new RegExp($str.escRegExp(key), 'gu'), staticDefs[key]);
            }
            return html;
        },
    };
};
