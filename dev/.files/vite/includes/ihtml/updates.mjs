/**
 * `./index.html` build-related tag updates.
 *
 * Vite is not aware of this config file's location.
 *
 * @note PLEASE DO NOT EDIT THIS FILE!
 * @note This entire file will be updated automatically.
 * @note Instead of editing here, please review <https://github.com/clevercanyon/skeleton>.
 */

import fs from 'node:fs';
import path from 'node:path';
import { $chalk } from '../../../../../node_modules/@clevercanyon/utilities.node/dist/index.js';
import { $mm, $obj } from '../../../../../node_modules/@clevercanyon/utilities/dist/index.js';
import extensions from '../../../bin/includes/extensions.mjs';
import u from '../../../bin/includes/utilities.mjs';

/**
 * Prepares `./index.html` build-related tag updates.
 *
 * @param   props Props from vite config file driver.
 *
 * @returns       Build-related property updates.
 */
export default async ({ command, isSSRBuild, projDir, appType, appEntries }) => {
    const updates = {}; // Initialize.

    if (!isSSRBuild && 'build' === command /* Only when building the app. */) {
        u.log($chalk.gray('Updating `baseURL` in `./index.html`.'));
        await u.updatePkg({ $set: { type: updates.type, sideEffects: updates.sideEffects } });
    }
    return updates;
};
