/**
 * Brand config plugin.
 *
 * Vite is not aware of this config file's location.
 *
 * @note PLEASE DO NOT EDIT THIS FILE!
 * @note This entire file will be updated automatically.
 * @note Instead of editing here, please review <https://github.com/clevercanyon/skeleton>.
 */

import { $json } from '../../../../../../../../node_modules/@clevercanyon/utilities/dist/index.js';
import u from '../../../../../../resources/utilities.mjs';

/**
 * Configures brand config plugin.
 *
 * @param   props Props from vite config file driver.
 *
 * @returns       Brand config plugin.
 */
export default async ({ mode, appBaseURL }) => {
    const virtualId = 'virtual:brand/config';
    const resolvedVirtualId = '\0' + virtualId;

    return {
        name: 'vite-plugin-c10n-brand-config',

        resolveId(id) {
            if (id === virtualId) {
                return '\0' + id;
            }
        },
        async load(id) {
            if (id === resolvedVirtualId) {
                return 'export default ' + $json.stringify(await u.brandConfig({ mode, baseURL: appBaseURL }), { pretty: true });
            }
        },
    };
};
