/**
 * Remark plugin.
 *
 * @note PLEASE DO NOT EDIT THIS FILE!
 * @note This entire file will be updated automatically.
 * @note Instead of editing here, please review <https://github.com/clevercanyon/skeleton>.
 */

import { h } from 'hastscript';
import { visit as unistVisit } from 'unist-util-visit';

/**
 * Generates HTML from remark directives.
 *
 *     :::main{#~remark-directive}
 *     Lorem:br
 *     ipsum.
 *
 *     ::hr{.border-color-danger}
 *
 *     A :i[lovely] language known as :abbr[HTML]{title="HyperText Markup Language"}.
 *     :::
 *
 * Produces:
 *
 *     <main id="~remark-directive">
 *      <p>Lorem<br>ipsum.</p>
 *      <hr class="border-color-danger">
 *      <p>A <i>lovely</i> language known as <abbr title="HyperText Markup Language">HTML</abbr>.</p>
 *     </main>
 *
 * @see https://github.com/remarkjs/remark-directive#use
 */
export default () => {
    return (tree) => {
        unistVisit(tree, (node) => {
            if (['containerDirective', 'leafDirective', 'textDirective'].includes(node.type)) {
                if (node.name === 'alert') return;

                const data = node.data || (node.data = {});
                const hast = h(node.name, node.attributes || {});

                data.hName = hast.tagName;
                data.hProperties = hast.properties;
            }
        });
    };
};
